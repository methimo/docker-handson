# 1. Docker について

## 1-1. 仮想化技術

- 1 台の物理サーバを複数の仮想サーバに分割して利用する仕組み
- それぞれの仮想サーバーで個別に OS やアプリケーションを実行でき、独立したサーバ環境として利用できる。

### 仮想化の手法

- ホスト OS：物理サーバ上にインストールした OS
- ゲスト OS：仮想化ソフトウェア上で起動する OS

1. ホスト型

   - ホスト OS 上にインストールした仮想化ソフトウェアから仮想のハードウェア環境をエミュレートすることで仮想サーバを実現
   - ハードウェアにアクセスする必要があるためオーバヘッドが大きい
   - 代表的な製品：VirtualBox(Oracle)
     <img src="/images/host.png" width="50%">

1. ハイパーバイザ型

   - ハードウェアに直接インストールされている仮想化ソフトウェア(ハイパーバイザ)を利用し、直接ハードウェアを制御することで仮想化を実現する
   - ホスト OS が不要。
   - 代表的な製品：XenServer(Citrix), Hyper-V(Microsoft)
     <img src="/images/hypervisor.png" width="50%">

1. コンテナ型
   - ホスト OS 上に論理的な区画(コンテナ)を作り、それぞれで独立したアプリケーション実行環境を稼働させる
   - ホスト OS からは各コンテナは 1 つのプロセスとして稼働し、OS カーネルやリソース(CPU,メモリ)を複数コンテナで共有する
   - ホスト OS のリソースを直接利用するため,オーバーヘッドが少ない
   - 代表的ソフトウェア：Docker(Docker Inc.)
     <img src="/images/container.png" width="50%">

## 1-2. Docker のアーキテクチャ

![abst](/images/abst.png)

- Docker デーモン
  - Docker コマンドの実行者
- Docker クライアント
  - ユーザが入力するインタフェース。コマンドラインや GUI がある
- Docker コンテナ
  - アプリを実行する空間。コンテナの中にアプリソースをはじめアプリ実行に必要な資源を格納する
- Docker イメージ
  - コンテナの元となるテンプレート。イメージからコンテナを作成する
- Dockerfile
  - イメージを作成するための命令を記載したファイル。
- Docker レジストリ
  - イメージの保管庫。インターネット上に公開されているもの(DockerHub)と、プライベートに構築可能なもの(DockerRegistry)がある

## 1-3. Docker のメリットデメリット

- メリット
  - OS 起動がないため起動が早い
  - コンテナ内で独立した環境を保持できるため本番/テスト環境の差分が発生しない(可搬性)
  - イメージがあるため環境を破壊してもすぐ復元できる(再現性)
  - カーネルのメモリが節約できアプリの集約密度をあげることができる
- デメリット
  - コンテナ削除時にコンテナ内のファイルシステムに書いたファイルが消える(揮発性)
  - 複数コンテナ起動時のリソース管理が大変
  - コンテナを停止せずに他ホスト OS に移動できない
